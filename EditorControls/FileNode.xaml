<local:FileControl x:Class="NotionPlay.EditorControls.FileNode"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:NotionPlay.EditorControls"
             xmlns:v="clr-namespace:MinimalisticWPF.Controls;assembly=MinimalisticWPF.Controls"
             mc:Ignorable="d"
             d:DesignHeight="30" d:DesignWidth="200">
    <local:FileControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/EditorControls/Resources/FileControlResources.xaml"/>
                <ResourceDictionary Source="/EditorControls/Resources/MenuButtonResources.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </local:FileControl.Resources>
    <local:FileControl.Template>
        <ControlTemplate TargetType="{x:Type local:FileControl}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="{Binding RelativeSource={RelativeSource AncestorType=local:FileControl},Path=Height}"/>
                    <ColumnDefinition Width="{Binding RelativeSource={RelativeSource AncestorType=local:FileControl},Path=Height}"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <!--触发按钮-->
                <v:Button x:Name="bt"
                          Grid.Column="0"
                          Data="{Binding RelativeSource={RelativeSource AncestorType=local:FileNode},Path=ButtonSymbol}"
                          Style="{StaticResource menubutton_center}"
                          Click="Button_Click"/>

                <v:Button x:Name="logo"
                          Grid.Column="1"
                          Data="{TemplateBinding FileTypeSymbol}"
                          Style="{StaticResource menubutton_logo}"
                          Click="Logo_Click"/>

                <v:Button x:Name="title"
                          Grid.Column="2"
                          Data="{TemplateBinding Header}"
                          Style="{StaticResource menubutton_logo}"
                          Click="Title_Click"
                          Margin="5,0,0,0"/>

                <!-- 弹出菜单 - 包含子项 -->
                <Popup x:Name="SubMenuPopup"
                       IsOpen="{Binding RelativeSource={RelativeSource AncestorType=local:FileNode},Path=IsOpen}"
                       Placement="{Binding RelativeSource={RelativeSource AncestorType=local:FileNode},Path=Placement}"
                       StaysOpen="True"
                       Focusable="True"
                       FocusVisualStyle="{x:Null}"
                       AllowsTransparency="True"
                       HorizontalOffset="{TemplateBinding Height}">
                    <ItemsPresenter />
                </Popup>
            </Grid>
        </ControlTemplate>
    </local:FileControl.Template>
</local:FileControl>
